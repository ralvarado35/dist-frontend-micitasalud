"use strict";(self.webpackChunkpreclinic_angular=self.webpackChunkpreclinic_angular||[]).push([[1525],{1525:(L,u,e)=>{e.r(u),e.d(u,{LoginModule:()=>Z});var g=e(6895),c=e(27),n=e(433),m=e(6382),t=e(4650),f=e(866);function v(o,_){1&o&&(t.TgZ(0,"div"),t._uU(1," Email is required. "),t.qZA())}function h(o,_){1&o&&(t.TgZ(0,"div"),t._uU(1," Please, enter valid email address. "),t.qZA())}function C(o,_){if(1&o&&(t.TgZ(0,"div",27),t.YNc(1,v,2,0,"div",28),t.YNc(2,h,2,0,"div",28),t.qZA()),2&o){const i=t.oxw();t.xp6(1),t.Q6J("ngIf",i.f.email.errors&&i.f.email.errors.required),t.xp6(1),t.Q6J("ngIf",i.f.email.errors&&i.f.email.errors.email)}}function d(o,_){1&o&&(t.TgZ(0,"div"),t._uU(1," Password is required. "),t.qZA())}function T(o,_){if(1&o&&(t.TgZ(0,"div",27),t.YNc(1,d,2,0,"div",28),t.qZA()),2&o){const i=t.oxw();t.xp6(1),t.Q6J("ngIf",i.f.password.errors&&i.f.password.errors.required)}}function r(o,_){1&o&&(t.TgZ(0,"div",29)(1,"strong"),t._uU(2,"Error!"),t.qZA(),t._UZ(3,"a",30),t._uU(4," El usuario y contrase\xf1a son incorrectos. "),t.TgZ(5,"button",31),t._UZ(6,"span",32),t.qZA()())}const l=function(o){return{"is-invalid":o}},p=[{path:"",component:(()=>{class o{get f(){return this.form.controls}constructor(i,a){this.auth=i,this.router=a,this.routes=m._,this.passwordClass=!1,this.ERROR=!1,this.form=new n.cw({email:new n.NI("",[n.kI.required,n.kI.email]),password:new n.NI("",[n.kI.required])})}ngOnInit(){if(this.imgClinic="assets/img/logo-03.png",this.logoClinic="assets/img/login-logo.png",localStorage.getItem("authenticated")){this.user=this.auth.user;let i=!1;this.user.roles.forEach(a=>{-1!=a.toUpperCase().indexOf("DOCTOR")&&(i=!0)}),this.router.navigate(i?[m._.doctorDashboard]:[m._.adminDashboard])}}loginFormSubmit(){this.form.valid&&(this.ERROR=!1,this.auth.login(this.form.value.email?this.form.value.email:"",this.form.value.password?this.form.value.password:"").subscribe(i=>{console.log(i),i?setTimeout(()=>{document.location.reload()},50):this.ERROR=!0},i=>{console.log(i)}))}togglePassword(){this.passwordClass=!this.passwordClass}static#t=this.\u0275fac=function(a){return new(a||o)(t.Y36(f.e),t.Y36(c.F0))};static#o=this.\u0275cmp=t.Xpm({type:o,selectors:[["app-login"]],decls:42,vars:17,consts:[[1,"main-wrapper","login-body"],[1,"container-fluid","px-0"],[1,"row"],[1,"col-lg-6"],[1,"login-sec"],[1,"log-img"],["alt","Logo",1,"img-fluid",3,"src"],[1,"col-lg-6","login-wrap-bg"],[1,"login-wrapper"],[1,"loginbox"],[1,"login-right"],[1,"login-right-wrap"],[1,"account-logo"],[3,"routerLink"],["alt","logoClinic",3,"src"],[3,"formGroup","ngSubmit"],[1,"form-group"],[1,"login-danger"],["formControlName","email","type","text",1,"form-control",3,"ngClass"],["class","invalid-feedback",4,"ngIf"],["formControlName","password",1,"form-control","pass-input",3,"type","ngClass"],[1,"profile-views","toggle-password",3,"ngClass","click"],[1,"form-group","login-btn"],["class","alert alert-danger alert-dismissible fade show","role","alert",4,"ngIf"],["type","submit",1,"btn","btn-primary","btn-block",3,"disabled"],[1,"next-sign"],[1,"account-subtitle"],[1,"invalid-feedback"],[4,"ngIf"],["role","alert",1,"alert","alert-danger","alert-dismissible","fade","show"],["href","javascript:void(0);",1,"alert-link"],["type","button","data-bs-dismiss","alert","aria-label","Close",1,"btn-close"],["aria-hidden","true"]],template:function(a,s){1&a&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4)(5,"div",5),t._UZ(6,"img",6),t.qZA()()(),t.TgZ(7,"div",7)(8,"div",8)(9,"div",9)(10,"div",10)(11,"div",11)(12,"div",12)(13,"a",13),t._UZ(14,"img",14),t.qZA()(),t.TgZ(15,"h2"),t._uU(16,"Login"),t.qZA(),t.TgZ(17,"form",15),t.NdJ("ngSubmit",function(){return s.loginFormSubmit()}),t.TgZ(18,"div",16)(19,"label"),t._uU(20,"Email "),t.TgZ(21,"span",17),t._uU(22,"*"),t.qZA()(),t._UZ(23,"input",18),t.YNc(24,C,3,2,"div",19),t.qZA(),t.TgZ(25,"div",16)(26,"label"),t._uU(27,"Password "),t.TgZ(28,"span",17),t._uU(29,"*"),t.qZA()(),t._UZ(30,"input",20),t.YNc(31,T,2,1,"div",19),t.TgZ(32,"span",21),t.NdJ("click",function(){return s.togglePassword()}),t.qZA()(),t.TgZ(33,"div",22),t.YNc(34,r,7,0,"div",23),t.TgZ(35,"button",24),t._uU(36," Login "),t.qZA()()(),t.TgZ(37,"div",25)(38,"p",26),t._uU(39," Necesitas una cita? "),t.TgZ(40,"a",13),t._uU(41,"Registrarse"),t.qZA()()()()()()()()()()()),2&a&&(t.xp6(6),t.Q6J("src",s.imgClinic,t.LSH),t.xp6(7),t.Q6J("routerLink",s.routes.adminDashboard),t.xp6(1),t.Q6J("src",s.logoClinic,t.LSH),t.xp6(3),t.Q6J("formGroup",s.form),t.xp6(6),t.Q6J("ngClass",t.VKq(13,l,s.f.email.touched&&s.f.email.invalid)),t.xp6(1),t.Q6J("ngIf",s.f.email.touched&&s.f.email.invalid),t.xp6(6),t.Q6J("type",s.passwordClass?"text":"password")("ngClass",t.VKq(15,l,s.f.password.touched&&s.f.password.invalid)),t.xp6(1),t.Q6J("ngIf",s.f.password.touched&&s.f.password.invalid),t.xp6(1),t.Q6J("ngClass",s.passwordClass?"feather icon-eye":"feather icon-eye-off"),t.xp6(2),t.Q6J("ngIf",s.ERROR),t.xp6(1),t.Q6J("disabled",s.form.invalid),t.xp6(5),t.Q6J("routerLink",s.routes.register))},dependencies:[g.mk,g.O5,c.rH,n._Y,n.Fj,n.JJ,n.JL,n.sg,n.u]})}return o})()}];let I=(()=>{class o{static#t=this.\u0275fac=function(a){return new(a||o)};static#o=this.\u0275mod=t.oAB({type:o});static#e=this.\u0275inj=t.cJS({imports:[c.Bz.forChild(p),c.Bz]})}return o})();var U=e(9079);let Z=(()=>{class o{static#t=this.\u0275fac=function(a){return new(a||o)};static#o=this.\u0275mod=t.oAB({type:o});static#e=this.\u0275inj=t.cJS({imports:[g.ez,I,U.m]})}return o})()},5862:(L,u,e)=>{e.d(u,{$g:()=>n});const n="http://api.micitasalud.com/api"},866:(L,u,e)=>{e.d(u,{e:()=>C});var g=e(6382),c=e(5862),n=e(4004),m=e(262),t=e(9646),f=e(4650),v=e(27),h=e(529);let C=(()=>{class d{constructor(r,l){this.router=r,this.http=l,this.getLocalStorage()}getLocalStorage(){if(localStorage.getItem("token")&&localStorage.getItem("user")){const r=localStorage.getItem("user");this.user=JSON.parse(r||""),this.token=localStorage.getItem("token")}else this.user=null,this.token=null}registerUser(r){return this.http.post(c.$g+"/auth/register",r)}login(r,l){return this.http.post(c.$g+"/auth/login",{email:r,password:l}).pipe((0,n.U)(p=>(console.log(p),this.saveLocalStorage(p))),(0,m.K)(p=>(console.log(p),(0,t.of)(void 0))))}saveLocalStorage(r){return!(!r||!r.access_token||(localStorage.setItem("token",r.access_token),localStorage.setItem("user",JSON.stringify(r.user)),localStorage.setItem("authenticated","true"),localStorage.setItem("clinic_id",r.user.clinic_id),0))}logout(){localStorage.removeItem("token"),localStorage.removeItem("user"),localStorage.removeItem("authenticated"),localStorage.removeItem("clinic_id"),this.router.navigate([g._.login])}static#t=this.\u0275fac=function(l){return new(l||d)(f.LFG(v.F0),f.LFG(h.eN))};static#o=this.\u0275prov=f.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"})}return d})()}}]);